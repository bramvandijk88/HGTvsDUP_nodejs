---
title: "Analyse HGT_vs_DUP JS data"
author: "Bram van Dijk"
date: "12/08/2020"
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}

# The code below is not necessary, but can improve graphical quality on certain windows 10 implementations
 trace(grDevices:::png, quote({
   if (missing(type) && missing(antialias)) {
     type <- "cairo-png"
     antialias <- "subpixel"
   }
 }), print = FALSE)

knitr::opts_chunk$set(echo = TRUE)


cols <- rep(c("dodgerblue2","#E31A1C", # red
              "green4",
              "#6A3D9A", # purple
              "#FF7F00", # orange
              "black","steelblue4",
              "skyblue2","#FB9A99", # lt pink
              "palegreen2",
              "#CAB2D6", # lt purple
              "#FDBF6F", # lt orange
              "gray70", "khaki2",
              "maroon","orchid1","deeppink1","blue1","gold1",
              "darkturquoise","green1","yellow4","yellow3",
              "darkorange4","brown"),20)


library(ggplot2)
library(dplyr)
library(tidyverse)
library(patchwork)

```


### Analyse data from HGT_vs_DUP (javascript implementation)
There are two types of output. Averages over time, and the raw data. This document plots histograms of the raw data fow now. Below, give the output file generated by the code <seed>_raw.txt, and it plots ... something. 


```{r cars, echo=FALSE}

#setwd('../Desktop/Programming shizzle/HGT_vs_DUP/Output/'); <-- Disabled for knitting
rawfile <- "../Output/602_raw.txt"
avgfile <- "../Output/602_avg.txt"
rawdata <- read.table(rawfile,sep=",");
avgdata <- read.table(avgfile,sep="",header=T);

# Renaming the first two columns, which are the timepoint and the variable-names
names(rawdata)[1] <- "time"
names(rawdata)[3] <- "variable"
names(rawdata)[2] <- "poptype"

# gathering the data into a long-format data frame structured:
# <timepoint,variable,value>
rawdata <- gather(rawdata, key,value,-c(time,variable,poptype))
# <timepoint,variable,poptype,value>


avgdata <- gather(avgdata,variable,value,-c(Time))

```

## Fitness distribution in population at variable points in time:

Here, some distributions are drawn using various plots:

```{r pressure, echo=TRUE}

rawdata %>% filter(time > 100000) %>% ggplot(aes(x=value,fill=poptype)) + geom_histogram(position = "dodge",bins=25,size=0.25,col="black") + facet_wrap(~variable,scale="free") + scale_fill_manual(values=cols) + theme_bw() 

p1 <- avgdata %>% filter(variable %in% c("AvglenDUP","AvglenHGT")) %>% ggplot(aes(x=Time,y=value,col=variable)) + geom_line(size=1) + theme_bw() + scale_colour_manual(values=cols)

p2 <- avgdata %>% filter(variable %in% c("AvgfitDUP","AvgfitHGT")) %>% ggplot(aes(x=Time,y=value,col=variable)) + geom_line(size=1) + theme_bw() + scale_colour_manual(values=cols)

p3 <- avgdata %>% filter(variable %in% c("exprDUP","exprHGT")) %>% ggplot(aes(x=Time,y=value,col=variable)) + geom_line(size=1) + theme_bw() + scale_colour_manual(values=cols)

# rawdata %>% filter(Time %in% seq(0,300000,by=50000)) %>% ggplot(aes(x=exprDUP,y=AvglenDUP)) + geom_point(size=1) + theme_bw() + scale_colour_manual(values=cols) + facet_wrap(~Time)

(p1/p2/p3)

```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
