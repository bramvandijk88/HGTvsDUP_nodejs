{"code":"!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,\"a\",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p=\"\",n(n.s=0)}([function(t,e,n){\"use strict\";n.r(e),function(t){n.d(e,\"cost_expr\",(function(){return u})),n.d(e,\"deletions\",(function(){return h})),n.d(e,\"duplications\",(function(){return l})),n.d(e,\"hgt\",(function(){return a})),n.d(e,\"mutate_expression\",(function(){return c})),n.d(e,\"mutate_up\",(function(){return m})),n.d(e,\"mut_step\",(function(){return p})),n.d(e,\"m\",(function(){return d}));var i=n(1),r=n(2);n(4);const s=document.querySelector.bind(document);let o=500,u=.005,h=.005,l=.005,a=.005,c=.001,m=.01,p=.2,f=56;var d=new r.a(f);let g=[],y=[],v=function(){g=[],y=[];for(let t=0;t<o;t++){const t=new i.a(1,\"dup\"),e=new i.a(1,\"hgt\");t.setFitness(),e.setFitness(),y.push(t),t.inpop=y,g.push(e),e.inpop=g}},_=0;v();let w=!0;function x(){M(y),M(g),_++}function M(t){for(let e=0;e<o;e++){let e=0;for(let n=0;n<t.length;n++)e+=t[n].fitness;let n=d.random()*e,r=0,s=-1;for(let e=0;e<t.length;e++)if(r+=t[e].fitness,r>n){s=e;break}let o=t[s],u=i.a.reproduceCell(o),h=Math.floor(d.random()*t.length);u.time_birth=_,t[h]=u}}if(\"object\"!=typeof t){s(\"#runpause\").addEventListener(\"click\",(function(){w=!w,console.log(\"Switched running to \",w)})),document.querySelector(\"#restart\").addEventListener(\"click\",(function(){f=Math.floor(1e3*Math.random()),document.querySelector(\"#seed\").value=f,window.clearGraphs(),_=0,v(),console.log(\"Restarted \",w)}));let t=document.querySelector(\"#seed\");t.value=f,t.addEventListener(\"change\",()=>f=t.value);let e=document.querySelector(\"#turnover\");e.value=l,e.addEventListener(\"change\",()=>{l=e.value,h=e.value,a=e.value});let n=document.querySelector(\"#cost\");n.value=u,n.addEventListener(\"change\",()=>u=n.value);let r=document.querySelector(\"#mu\");r.value=c,r.addEventListener(\"change\",()=>c=r.value);let x=document.querySelector(\"#stepsize\");x.value=p,x.addEventListener(\"change\",()=>p=x.value);let M=document.querySelector(\"#up\");M.value=m,M.addEventListener(\"change\",()=>m=M.value);let b=s(\"#Nbox\");b.value=o,b.addEventListener(\"change\",()=>{let t=o,e=b.value;if(e=min(10,max(e,5e3)),t>e)g=g.slice(0,e),y=y.slice(0,e);else{for(;g.length<e;){let t=Math.floor(d.random()*g.length);g.push(i.a.reproduceCell(g[t]))}for(;y.length<e;){let t=Math.floor(d.random()*y.length);y.push(i.a.reproduceCell(y[t]))}}o=e})}\"undefined\"==typeof window?function(){for(;_<1e5;)w&&x()}():function t(){let e=requestAnimationFrame(t);if(w){let t=0;for(;t<16;){let e=performance.now();x(),t+=performance.now()-e,_%100==0&&(console.log(\"Time: \"+_),console.log(\"Seed: \"+f),console.log(`Rates: ${h} ${l} ${a}`),console.log(\"Cost: \"+u),console.log(\"Mu: \"+c),console.log(\"Duppin pop:\",y),console.log(\"HGTing pop:\",g))}!function(){let t=y.map(({genomesize:t})=>t),e=g.map(({genomesize:t})=>t),n=y.map(({fitness:t})=>t),i=g.map(({fitness:t})=>t),r=y.map(({sumexpression:t})=>t);r=r.map((function(e,n){return e/t[n]}));let s=g.map(({sumexpression:t})=>t);s=s.map((function(t,n){return t/e[n]})),window.updateGraphG(_,t,e),window.updateGraphF(_,n,i),window.updateGraphE(_,r,s)}(),1e5===_&&(cancelAnimationFrame(e),console.log(y),console.log(\"done\"))}}()}.call(this,n(3))},function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return u}));let i=0;class r{constructor(t){this.id=i++,this.expression=t}static copyGene(t){const e=new r(0);return e.expression=t.expression,e}}var s=n(0);let o=0;class u{constructor(t,e){this.uid=o++,this.time_birth=0,this.sum_hgt=0,this.sum_dup=0,this.type=e,this.genome=[],this.genomesize=0,this.sumexpression=0;for(let e=0;e<t;e++){this.genomesize++;const t=new r(1);this.sumexpression+=1,this.genome.push(t)}}static reproduceCell(t){let e=new u(0);e.fitness=t.fitness,e.genome=[],e.inpop=t.inpop,e.sum_hgt=t.sum_hgt,e.sum_dup=t.sum_dup,e.sumexpression=t.sumexpression,e.type=t.type;for(let n=0;n<t.genome.length;n++){const i=r.copyGene(t.genome[n]);e.genome.push(i)}let n=e.mutate();return e.genomesize=e.genome.length,n&&e.setFitness(),e}mutate(){let t=!1,e=s.mutate_expression,n=s.duplications,i=s.hgt,o=s.deletions;\"dup\"===this.type&&(i=0),\"hgt\"===this.type&&(n=0);for(let u=0;u<this.genome.length;u++){let h=s.m.random();if(h<e)t=!0,s.m.random()<s.mutate_up?this.genome[u].expression=Math.min(1,Math.max(.01,this.genome[u].expression+s.m.random()*s.mut_step)):this.genome[u].expression=Math.min(1,Math.max(.01,this.genome[u].expression-s.m.random()*s.mut_step));else if(h<e+n){t=!0;const e=r.copyGene(this.genome[u]);this.sum_dup++,this.genome.push(e)}else if(h<e+n+i){t=!0;let e=Math.floor(s.m.random()*this.inpop.length),n=this.inpop[e];if(!(n.genome.length>0))throw new Error(\"Does this ever happen?\");{let t=Math.floor(s.m.random(),n.genome.length);const e=r.copyGene(n.genome[t]);this.sum_hgt++,this.genome.push(e)}}else if(h<e+n+i+o){t=!0;let e=Math.ceil(s.m.random()*this.genome.length);this.genome.splice(e)}}return t}setFitness(){this.sumexpression=0,this.fitness=0;for(let t of this.genome)this.sumexpression+=t.expression;this.fitness=this.sumexpression>1?1:this.sumexpression,this.fitness-=s.cost_expr*this.sumexpression}}},function(t,e,n){\"use strict\";function i(t){null==t&&(t=(new Date).getTime()),this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,this.init_genrand(t)}n.d(e,\"a\",(function(){return i})),i.prototype.init_genrand=function(t){for(this.mt[0]=t>>>0,this.mti=1;this.mti<this.N;this.mti++){t=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(1812433253*((4294901760&t)>>>16)<<16)+1812433253*(65535&t)+this.mti,this.mt[this.mti]>>>=0}},i.prototype.init_by_array=function(t,e){var n,i,r;for(this.init_genrand(19650218),n=1,i=0,r=this.N>e?this.N:e;r;r--){var s=this.mt[n-1]^this.mt[n-1]>>>30;this.mt[n]=(this.mt[n]^(1664525*((4294901760&s)>>>16)<<16)+1664525*(65535&s))+t[i]+i,this.mt[n]>>>=0,i++,++n>=this.N&&(this.mt[0]=this.mt[this.N-1],n=1),i>=e&&(i=0)}for(r=this.N-1;r;r--){s=this.mt[n-1]^this.mt[n-1]>>>30;this.mt[n]=(this.mt[n]^(1566083941*((4294901760&s)>>>16)<<16)+1566083941*(65535&s))-n,this.mt[n]>>>=0,++n>=this.N&&(this.mt[0]=this.mt[this.N-1],n=1)}this.mt[0]=2147483648},i.prototype.genrand_int32=function(){var t,e=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var n;for(this.mti==this.N+1&&this.init_genrand(5489),n=0;n<this.N-this.M;n++)t=this.mt[n]&this.UPPER_MASK|this.mt[n+1]&this.LOWER_MASK,this.mt[n]=this.mt[n+this.M]^t>>>1^e[1&t];for(;n<this.N-1;n++)t=this.mt[n]&this.UPPER_MASK|this.mt[n+1]&this.LOWER_MASK,this.mt[n]=this.mt[n+(this.M-this.N)]^t>>>1^e[1&t];t=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^t>>>1^e[1&t],this.mti=0}return t=this.mt[this.mti++],t^=t>>>11,t^=t<<7&2636928640,t^=t<<15&4022730752,(t^=t>>>18)>>>0},i.prototype.genrand_int31=function(){return this.genrand_int32()>>>1},i.prototype.genrand_real1=function(){return this.genrand_int32()*(1/4294967295)},i.prototype.random=function(){return this.genrand_int32()*(1/4294967296)},i.prototype.genrand_real3=function(){return(this.genrand_int32()+.5)*(1/4294967296)},i.prototype.genrand_res53=function(){return(67108864*(this.genrand_int32()>>>5)+(this.genrand_int32()>>>6))*(1/9007199254740992)}},function(t,e){var n,i,r=t.exports={};function s(){throw new Error(\"setTimeout has not been defined\")}function o(){throw new Error(\"clearTimeout has not been defined\")}function u(t){if(n===setTimeout)return setTimeout(t,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n=\"function\"==typeof setTimeout?setTimeout:s}catch(t){n=s}try{i=\"function\"==typeof clearTimeout?clearTimeout:o}catch(t){i=o}}();var h,l=[],a=!1,c=-1;function m(){a&&h&&(a=!1,h.length?l=h.concat(l):c=-1,l.length&&p())}function p(){if(!a){var t=u(m);a=!0;for(var e=l.length;e;){for(h=l,l=[];++c<e;)h&&h[c].run();c=-1,e=l.length}h=null,a=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function d(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new f(t,e)),1!==l.length||a||u(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title=\"browser\",r.browser=!0,r.env={},r.argv=[],r.version=\"\",r.versions={},r.on=d,r.addListener=d,r.once=d,r.off=d,r.removeListener=d,r.removeAllListeners=d,r.emit=d,r.prependListener=d,r.prependOnceListener=d,r.listeners=function(t){return[]},r.binding=function(t){throw new Error(\"process.binding is not supported\")},r.cwd=function(){return\"/\"},r.chdir=function(t){throw new Error(\"process.chdir is not supported\")},r.umask=function(){return 0}},function(t,e,n){\"use strict\"}]);","extractedComments":[]}